package S2;

import N2.h;
import N2.l;
import N2.n;
import f2.C1961B;
import f2.s;
import f2.z;
import i2.C2073A;
import i2.C2076a;
import i2.L;
import i2.p;
import java.io.EOFException;
import java.math.RoundingMode;
import pb.e;
import z2.B;
import z2.C2969m;
import z2.C2972p;
import z2.C2973q;
import z2.D;
import z2.F;
import z2.I;
import z2.O;
import z2.r;
import z2.u;

public final class f implements C2972p {

    /* renamed from: u  reason: collision with root package name */
    public static final u f5862u = new d();

    /* renamed from: v  reason: collision with root package name */
    private static final h.a f5863v = new e();

    /* renamed from: a  reason: collision with root package name */
    private final int f5864a;

    /* renamed from: b  reason: collision with root package name */
    private final long f5865b;

    /* renamed from: c  reason: collision with root package name */
    private final C2073A f5866c;

    /* renamed from: d  reason: collision with root package name */
    private final F.a f5867d;

    /* renamed from: e  reason: collision with root package name */
    private final B f5868e;

    /* renamed from: f  reason: collision with root package name */
    private final D f5869f;

    /* renamed from: g  reason: collision with root package name */
    private final O f5870g;

    /* renamed from: h  reason: collision with root package name */
    private r f5871h;

    /* renamed from: i  reason: collision with root package name */
    private O f5872i;

    /* renamed from: j  reason: collision with root package name */
    private O f5873j;

    /* renamed from: k  reason: collision with root package name */
    private int f5874k;

    /* renamed from: l  reason: collision with root package name */
    private z f5875l;

    /* renamed from: m  reason: collision with root package name */
    private long f5876m;

    /* renamed from: n  reason: collision with root package name */
    private long f5877n;

    /* renamed from: o  reason: collision with root package name */
    private long f5878o;

    /* renamed from: p  reason: collision with root package name */
    private int f5879p;

    /* renamed from: q  reason: collision with root package name */
    private g f5880q;

    /* renamed from: r  reason: collision with root package name */
    private boolean f5881r;

    /* renamed from: s  reason: collision with root package name */
    private boolean f5882s;

    /* renamed from: t  reason: collision with root package name */
    private long f5883t;

    public f() {
        this(0);
    }

    private void d() {
        C2076a.i(this.f5872i);
        L.h(this.f5871h);
    }

    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r0v0, resolved type: S2.g} */
    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r1v1, resolved type: S2.c} */
    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r0v1, resolved type: S2.b} */
    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r0v5, resolved type: S2.b} */
    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r0v6, resolved type: S2.b} */
    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r0v13, resolved type: S2.b} */
    /* JADX DEBUG: Multi-variable search result rejected for TypeSearchVarInfo{r4v1, resolved type: S2.b} */
    /* JADX WARNING: Code restructure failed: missing block: B:15:0x004e, code lost:
        if (r0 == null) goto L_0x0051;
     */
    /* JADX WARNING: Code restructure failed: missing block: B:16:0x0051, code lost:
        r0 = null;
     */
    /* JADX WARNING: Multi-variable type inference failed */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    private S2.g e(z2.C2973q r12) {
        /*
            r11 = this;
            S2.g r0 = r11.u(r12)
            f2.z r1 = r11.f5875l
            long r2 = r12.getPosition()
            S2.c r1 = t(r1, r2)
            boolean r2 = r11.f5881r
            if (r2 == 0) goto L_0x0018
            S2.g$a r12 = new S2.g$a
            r12.<init>()
            return r12
        L_0x0018:
            int r2 = r11.f5864a
            r2 = r2 & 4
            if (r2 == 0) goto L_0x004a
            if (r1 == 0) goto L_0x002b
            long r2 = r1.g()
            long r0 = r1.d()
        L_0x0028:
            r9 = r0
            r5 = r2
            goto L_0x003f
        L_0x002b:
            if (r0 == 0) goto L_0x0036
            long r2 = r0.g()
            long r0 = r0.d()
            goto L_0x0028
        L_0x0036:
            f2.z r0 = r11.f5875l
            long r2 = o(r0)
            r0 = -1
            goto L_0x0028
        L_0x003f:
            S2.b r0 = new S2.b
            long r7 = r12.getPosition()
            r4 = r0
            r4.<init>(r5, r7, r9)
            goto L_0x0052
        L_0x004a:
            if (r1 == 0) goto L_0x004e
            r0 = r1
            goto L_0x0052
        L_0x004e:
            if (r0 == 0) goto L_0x0051
            goto L_0x0052
        L_0x0051:
            r0 = 0
        L_0x0052:
            r1 = 1
            if (r0 == 0) goto L_0x0060
            boolean r2 = r0.e()
            if (r2 != 0) goto L_0x006c
            int r2 = r11.f5864a
            r2 = r2 & r1
            if (r2 == 0) goto L_0x006c
        L_0x0060:
            int r0 = r11.f5864a
            r0 = r0 & 2
            if (r0 == 0) goto L_0x0067
            goto L_0x0068
        L_0x0067:
            r1 = 0
        L_0x0068:
            S2.g r0 = r11.n(r12, r1)
        L_0x006c:
            return r0
        */
        throw new UnsupportedOperationException("Method not decompiled: S2.f.e(z2.q):S2.g");
    }

    private long g(long j10) {
        return this.f5876m + ((j10 * 1000000) / ((long) this.f5867d.f29102d));
    }

    private g m(long j10, i iVar, long j11) {
        long j12;
        long j13;
        i iVar2 = iVar;
        long a10 = iVar.a();
        if (a10 == -9223372036854775807L) {
            return null;
        }
        long j14 = iVar2.f5891c;
        if (j14 != -1) {
            long j15 = j10 + j14;
            j12 = j14 - ((long) iVar2.f5889a.f29101c);
            j13 = j15;
        } else if (j11 == -1) {
            return null;
        } else {
            j12 = (j11 - j10) - ((long) iVar2.f5889a.f29101c);
            j13 = j11;
        }
        long j16 = j12;
        RoundingMode roundingMode = RoundingMode.HALF_UP;
        return new a(j13, j10 + ((long) iVar2.f5889a.f29101c), com.google.common.primitives.f.d(L.W0(j16, 8000000, a10, roundingMode)), com.google.common.primitives.f.d(e.b(j16, iVar2.f5890b, roundingMode)), false);
    }

    private g n(C2973q qVar, boolean z10) {
        qVar.l(this.f5866c.e(), 0, 4);
        this.f5866c.U(0);
        this.f5867d.a(this.f5866c.q());
        return new a(qVar.a(), qVar.getPosition(), this.f5867d, z10);
    }

    private static long o(z zVar) {
        if (zVar == null) {
            return -9223372036854775807L;
        }
        int e10 = zVar.e();
        for (int i10 = 0; i10 < e10; i10++) {
            z.b d10 = zVar.d(i10);
            if (d10 instanceof n) {
                n nVar = (n) d10;
                if (nVar.f4418a.equals("TLEN")) {
                    return L.L0(Long.parseLong((String) nVar.f4432d.get(0)));
                }
            }
        }
        return -9223372036854775807L;
    }

    private static int p(C2073A a10, int i10) {
        if (a10.g() >= i10 + 4) {
            a10.U(i10);
            int q10 = a10.q();
            if (q10 == 1483304551 || q10 == 1231971951) {
                return q10;
            }
        }
        if (a10.g() < 40) {
            return 0;
        }
        a10.U(36);
        if (a10.q() == 1447187017) {
            return 1447187017;
        }
        return 0;
    }

    private static boolean q(int i10, long j10) {
        if (((long) (i10 & -128000)) == (j10 & -128000)) {
            return true;
        }
        return false;
    }

    /* access modifiers changed from: private */
    public static /* synthetic */ C2972p[] r() {
        return new C2972p[]{new f()};
    }

    /* access modifiers changed from: private */
    public static /* synthetic */ boolean s(int i10, int i11, int i12, int i13, int i14) {
        if ((i11 == 67 && i12 == 79 && i13 == 77 && (i14 == 77 || i10 == 2)) || (i11 == 77 && i12 == 76 && i13 == 76 && (i14 == 84 || i10 == 2))) {
            return true;
        }
        return false;
    }

    private static c t(z zVar, long j10) {
        if (zVar == null) {
            return null;
        }
        int e10 = zVar.e();
        for (int i10 = 0; i10 < e10; i10++) {
            z.b d10 = zVar.d(i10);
            if (d10 instanceof l) {
                return c.a(j10, (l) d10, o(zVar));
            }
        }
        return null;
    }

    private g u(C2973q qVar) {
        int i10;
        int i11;
        C2073A a10 = new C2073A(this.f5867d.f29101c);
        qVar.l(a10.e(), 0, this.f5867d.f29101c);
        F.a aVar = this.f5867d;
        int i12 = 21;
        if ((aVar.f29099a & 1) != 0) {
            if (aVar.f29103e != 1) {
                i12 = 36;
            }
        } else if (aVar.f29103e == 1) {
            i12 = 13;
        }
        int p10 = p(a10, i12);
        if (p10 != 1231971951) {
            if (p10 == 1447187017) {
                h a11 = h.a(qVar.a(), qVar.getPosition(), this.f5867d, a10);
                qVar.j(this.f5867d.f29101c);
                return a11;
            } else if (p10 != 1483304551) {
                qVar.e();
                return null;
            }
        }
        i b10 = i.b(this.f5867d, a10);
        if (!(this.f5868e.a() || (i10 = b10.f5892d) == -1 || (i11 = b10.f5893e) == -1)) {
            B b11 = this.f5868e;
            b11.f29073a = i10;
            b11.f29074b = i11;
        }
        long position = qVar.getPosition();
        if (!(qVar.a() == -1 || b10.f5891c == -1 || qVar.a() == b10.f5891c + position)) {
            p.f("Mp3Extractor", "Data size mismatch between stream (" + qVar.a() + ") and Xing frame (" + (b10.f5891c + position) + "), using Xing value.");
        }
        qVar.j(this.f5867d.f29101c);
        if (p10 == 1483304551) {
            return j.a(b10, position);
        }
        return m(position, b10, qVar.a());
    }

    private boolean v(C2973q qVar) {
        g gVar = this.f5880q;
        if (gVar != null) {
            long d10 = gVar.d();
            if (d10 != -1 && qVar.g() > d10 - 4) {
                return true;
            }
        }
        try {
            return !qVar.c(this.f5866c.e(), 0, 4, true);
        } catch (EOFException unused) {
            return true;
        }
    }

    private int w(C2973q qVar) {
        z zVar;
        if (this.f5874k == 0) {
            try {
                y(qVar, false);
            } catch (EOFException unused) {
                return -1;
            }
        }
        if (this.f5880q == null) {
            g e10 = e(qVar);
            this.f5880q = e10;
            this.f5871h.u(e10);
            s.b W10 = new s.b().o0(this.f5867d.f29100b).f0(4096).N(this.f5867d.f29103e).p0(this.f5867d.f29102d).V(this.f5868e.f29073a).W(this.f5868e.f29074b);
            if ((this.f5864a & 8) != 0) {
                zVar = null;
            } else {
                zVar = this.f5875l;
            }
            s.b h02 = W10.h0(zVar);
            if (this.f5880q.l() != -2147483647) {
                h02.M(this.f5880q.l());
            }
            this.f5873j.c(h02.K());
            this.f5878o = qVar.getPosition();
        } else if (this.f5878o != 0) {
            long position = qVar.getPosition();
            long j10 = this.f5878o;
            if (position < j10) {
                qVar.j((int) (j10 - position));
            }
        }
        return x(qVar);
    }

    private int x(C2973q qVar) {
        if (this.f5879p == 0) {
            qVar.e();
            if (v(qVar)) {
                return -1;
            }
            this.f5866c.U(0);
            int q10 = this.f5866c.q();
            if (!q(q10, (long) this.f5874k) || F.j(q10) == -1) {
                qVar.j(1);
                this.f5874k = 0;
                return 0;
            }
            this.f5867d.a(q10);
            if (this.f5876m == -9223372036854775807L) {
                this.f5876m = this.f5880q.b(qVar.getPosition());
                if (this.f5865b != -9223372036854775807L) {
                    this.f5876m += this.f5865b - this.f5880q.b(0);
                }
            }
            F.a aVar = this.f5867d;
            this.f5879p = aVar.f29101c;
            g gVar = this.f5880q;
            if (gVar instanceof b) {
                b bVar = (b) gVar;
                bVar.f(g(this.f5877n + ((long) aVar.f29105g)), qVar.getPosition() + ((long) this.f5867d.f29101c));
                if (this.f5882s && bVar.a(this.f5883t)) {
                    this.f5882s = false;
                    this.f5873j = this.f5872i;
                }
            }
        }
        int a10 = this.f5873j.a(qVar, this.f5879p, true);
        if (a10 == -1) {
            return -1;
        }
        int i10 = this.f5879p - a10;
        this.f5879p = i10;
        if (i10 > 0) {
            return 0;
        }
        this.f5873j.d(g(this.f5877n), 1, this.f5867d.f29101c, 0, (O.a) null);
        this.f5877n += (long) this.f5867d.f29105g;
        this.f5879p = 0;
        return 0;
    }

    private boolean y(C2973q qVar, boolean z10) {
        int i10;
        int i11;
        int i12;
        int j10;
        h.a aVar;
        if (z10) {
            i10 = 32768;
        } else {
            i10 = 131072;
        }
        qVar.e();
        if (qVar.getPosition() == 0) {
            if ((this.f5864a & 8) == 0) {
                aVar = null;
            } else {
                aVar = f5863v;
            }
            z a10 = this.f5869f.a(qVar, aVar);
            this.f5875l = a10;
            if (a10 != null) {
                this.f5868e.c(a10);
            }
            i11 = (int) qVar.g();
            if (!z10) {
                qVar.j(i11);
            }
            i12 = 0;
        } else {
            i11 = 0;
            i12 = 0;
        }
        int i13 = i12;
        int i14 = i13;
        while (true) {
            if (!v(qVar)) {
                this.f5866c.U(0);
                int q10 = this.f5866c.q();
                if ((i12 == 0 || q(q10, (long) i12)) && (j10 = F.j(q10)) != -1) {
                    i13++;
                    if (i13 != 1) {
                        if (i13 == 4) {
                            break;
                        }
                    } else {
                        this.f5867d.a(q10);
                        i12 = q10;
                    }
                    qVar.h(j10 - 4);
                } else {
                    int i15 = i14 + 1;
                    if (i14 != i10) {
                        if (z10) {
                            qVar.e();
                            qVar.h(i11 + i15);
                        } else {
                            qVar.j(1);
                        }
                        i13 = 0;
                        i14 = i15;
                        i12 = 0;
                    } else if (z10) {
                        return false;
                    } else {
                        throw C1961B.a("Searched too many bytes.", (Throwable) null);
                    }
                }
            } else if (i13 <= 0) {
                throw new EOFException();
            }
        }
        if (z10) {
            qVar.j(i11 + i14);
        } else {
            qVar.e();
        }
        this.f5874k = i12;
        return true;
    }

    public void a(long j10, long j11) {
        this.f5874k = 0;
        this.f5876m = -9223372036854775807L;
        this.f5877n = 0;
        this.f5879p = 0;
        this.f5883t = j11;
        g gVar = this.f5880q;
        if ((gVar instanceof b) && !((b) gVar).a(j11)) {
            this.f5882s = true;
            this.f5873j = this.f5870g;
        }
    }

    public void f(r rVar) {
        this.f5871h = rVar;
        O d10 = rVar.d(0, 1);
        this.f5872i = d10;
        this.f5873j = d10;
        this.f5871h.k();
    }

    public int i(C2973q qVar, I i10) {
        d();
        int w10 = w(qVar);
        if (w10 == -1 && (this.f5880q instanceof b)) {
            long g10 = g(this.f5877n);
            if (this.f5880q.g() != g10) {
                ((b) this.f5880q).h(g10);
                this.f5871h.u(this.f5880q);
            }
        }
        return w10;
    }

    public boolean j(C2973q qVar) {
        return y(qVar, true);
    }

    public void l() {
        this.f5881r = true;
    }

    public f(int i10) {
        this(i10, -9223372036854775807L);
    }

    public f(int i10, long j10) {
        this.f5864a = (i10 & 2) != 0 ? i10 | 1 : i10;
        this.f5865b = j10;
        this.f5866c = new C2073A(10);
        this.f5867d = new F.a();
        this.f5868e = new B();
        this.f5876m = -9223372036854775807L;
        this.f5869f = new D();
        C2969m mVar = new C2969m();
        this.f5870g = mVar;
        this.f5873j = mVar;
    }

    public void release() {
    }
}
